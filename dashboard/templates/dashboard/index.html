{% extends 'base(dashboard).html' %}
{% load static %}
{% block content %} 
<div class="nk-content ">
    <div class="nk-content nk-content-lg nk-content-fluid">
        <div class="container-xl wide-lg">
            <div class="nk-content-inner">
                <div class="nk-content-body">
                    <div class="nk-block-head nk-block-head-lg wide-xs mx-auto">
                        <div class="nk-block-head-content text-center">
                            <h2 class="nk-block-title fw-normal">Hello, {{ user.username }}!</h2>
                            {% if user.billing_user.first.free_trial %}
                            <div class="example-alert mb-2">
                                <div class="alert alert-fill alert-warning alert-icon">
                                    <em class="icon ni ni-alert-circle"></em> Your Free trial <strong>Will expire on the</strong>{{ get_billing.get_next_billing }}({{ get_billing.get_day }} days remaining) <a href="#" class="alert-link">Pay Now</a> if auto renew is disabuled</div>
                            </div>
                            {% endif %}
                            <div class="nk-block-des">
                                <p>Welcome to your <strong>Dashboard</strong>. You are few steps away from getting your website.</p>
                            </div>
                        </div>
                    </div><!-- .nk-block-head -->
                    {% if website %}
                    <div class="nk-block">
                        <div class="card card-custom-s1 card-bordered">
                            <div class="card-inner card-inner-lg h-100">
                                <div class="align-center flex-wrap flex-md-nowrap g-3 h-100">
                                    <div class="nk-block-content">
                                        <div class="nk-block-content-head">
                                            <h4>My website</h4>
                                        </div>
                                        {% if website %}
                                        <div class="nk-block-content-head">
                                            <div class="nk-wg1">
                                                {% for w in website %}
                                                <div class="nk-wg1-block">
                                                    <p><img src="" alt="">{{ w.name }}</p>
                                                </div>
                                                {% endfor %}
                                            </div>    
                                        </div>
                                        {% endif %}
                                        <a href="{{ website.domain }}/admin" class="btn btn-lg btn-primary">Go To Website</a>
                                    </div>
                                </div>
                            </div>
                        </div><!-- .card -->
                    </div><!-- .nk-block -->
                    {% else %}
                    <div class="nk-block">
                        <div class="card card-custom-s1 card-bordered">
                            <div class="row no-gutters">
                                <div class="col-lg-12">
                                    <div class="card-inner-group">
                                        <div class="card-inner">
                                            <h5>Letâ€™s Finish Your Website</h5>
                                            <p>Bulling a website takes about 1 to 3 day depending on the type of a website</p>
                                        </div>
                                        <div class="card-inner">
                                            <ul class="list list-step">
                                                <li class="list-step-{% if timeline.register == 'complited' %}done{% elif timeline.register == 'current' %}current{% endif %}">Register</li>
                                                <li class="list-step-{% if timeline.set_up_payment_method == 'complited' %}done{% elif timeline.set_up_payment_method == 'current' %}current{% endif %}">Set up payment method</li>
                                                <li class="list-step-{% if timeline.website_creation == 'complited' %}done{% elif timeline.website_creation == 'current' %}current{% endif %}">Website Creation</li>
                                                <li class="list-step-{% if timeline.website_review == 'complited' %}done{% elif timeline.website_review == 'current' %}current{% endif %}">Website Reviwe</li>
                                                <li class="list-step-{% if timeline.publish_website == 'complited' %}done{% elif timeline.publish_website == 'current' %}current{% endif %}">Publish Website</li>
                                            </ul>
                                        </div>
                                        <div class="card-inner">
                                            <div class="align-center gx-3">
                                                <div class="flex-item">
                                                    <div class="progress progress-sm progress-pill w-80px">
                                                        <div class="progress-bar" data-progress="{{ timeline.completed }}"></div>
                                                    </div>
                                                </div>
                                                <div class="flex-item">
                                                    <span class="sub-text sub-text-sm text-soft">2/5 Completed</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- .col -->
                            </div><!-- .row -->
                        </div><!-- .card -->
                    </div><!-- .nk-block -->
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="nk-block">
        <div class="row g-gs">
            <div class="col-lg-6">
                <a href="{% url 'personal-info' %}" class="card text-soft">
                    <div class="card-inner">
                        <div class="align-center justify-between">
                            <div class="g">
                                <h6 class="title">Personal Info</h6>
                                <p>See your profile data and manage your Account to choose what is saved in our system.</p>
                            </div>
                            <div class="g">
                                <span class="btn btn-icon btn-trigger mr-n1"><em class="icon ni ni-chevron-right"></em></span>
                            </div>
                        </div>
                    </div>
                </a>
            </div><!-- .col -->
            <div class="col-lg-6">
                <a href="{% url 'settings' %}" class="card text-soft">
                    <div class="card-inner">
                        <div class="align-center justify-between">
                            <div class="g">
                                <h6 class="title">Security Setting</h6>
                                <p>You have full control to manage your own account and keep account fully secure.</p>
                            </div>
                            <div class="g">
                                <span class="btn btn-icon btn-trigger mr-n1"><em class="icon ni ni-chevron-right"></em></span>
                            </div>
                        </div>
                    </div>
                </a>
            </div><!-- .col -->
            <div class="col-lg-6">
                <a href="{% url 'billing' %}" class="card text-soft">
                    <div class="card-inner">
                        <div class="align-center justify-between">
                            <div class="g">
                                <h6 class="title">Billing History</h6>
                                <p>Check out all your payment history. You can also download or print your invoice.</p>
                            </div>
                            <div class="g">
                                <span class="btn btn-icon btn-trigger mr-n1"><em class="icon ni ni-chevron-right"></em></span>
                            </div>
                        </div>
                    </div>
                </a>
            </div><!-- .col -->
            <div class="col-lg-6">
                <a href="{% url 'subscriptions' %}" class="card text-soft">
                    <div class="card-inner">
                        <div class="align-center justify-between">
                            <div class="g">
                                <h6 class="title">Account Reports</h6>
                                <p>Check your reports of uses and manage your packages or subscriptions that you have.</p>
                            </div>
                            <div class="g"></div>
                                <span class="btn btn-icon btn-trigger mr-n1"><em class="icon ni ni-chevron-right"></em></span>
                            </div>
                        </div>
                    </div>
                </a>
            </div><!-- .col -->
        </div><!-- .row -->
    </div><!-- .nk-block -->
    <div class="nk-block">
        <div class="card card-bordered">
            {% if billing %}
            <div class="card-inner-group">
                <div class="card-inner">
                    <div class="between-center flex-wrap flex-md-nowrap g-3">
                        <div class="nk-block-text">
                            <h6>{{ billing.plan }} Plan - <span class="text-base">{{ user.currency }} {{ billing.ammount }} /{% if billing.billed_monthly %}Monthly{% else %}Yearly{% endif %}</span></h6>
                            <p class="text-soft">priority support 24/7 uptime, powerfull features and more...</p>
                        </div>
                        <div class="nk-block-actions flex-shrink-0">
                            <a href="{% url 'subscriptions' %}" class="btn btn-primary">View Plan</a>
                        </div>
                    </div>
                </div><!-- .nk-card-inner -->
                <div class="card-inner">
                    <div class="between-center flex-wrap flex-md-nowrap g-3">
                        <div class="nk-block-text">
                            <p>Learn more about our <a href="{% url 'article:article_detail' category_slug='subscription' article_slug='subscription options' %}">subscription options</a>.</p>
                        </div>
                    </div>
                </div><!-- .nk-card-inner -->
            </div>
            {% endif %}
        </div>
    </div><!-- .nk-block -->
    <div class="nk-block">
        <div class="card card-bordered">
            <div class="card-inner">
                <div class="nk-help">
                    <div class="nk-help-text">
                        <h5>Weâ€™re here to help you!</h5>
                        <p class="text-soft">Ask a question or file a support ticketn or report an issues. Our team support team will get back to you by email.</p>
                    </div>
                    <div class="nk-help-action pt-3">
                        <a href="{% url 'contact' %}" class="btn btn-lg btn-outline-primary">Get Support Now</a>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- .nk-block -->
    <div class="nk-block">
        <div class="card card-bordered">
            <div class="card-inner card-inner-md">
                <div class="card-title-group">
                    <h6 class="card-title">Payment History</h6>
                    <div class="card-action">
                        <a href="{% url 'payment-hestory' %}" class="link link-sm">See All <em class="icon ni ni-chevron-right"></em></a>
                    </div>
                </div>
            </div>
            <table class="table table-tranx">
                <thead>
                    <tr class="tb-tnx-head">
                        <th class="tb-tnx-id"><span class="">#</span></th>
                        <th class="tb-tnx-info">
                            <span class="tb-tnx-desc d-none d-sm-inline-block">
                                <span>Bill For</span>
                            </span>
                            <span class="tb-tnx-date d-md-inline-block d-none">
                                <span class="d-md-none">Date</span>
                                <span class="d-none d-md-block">
                                    <span>Issue Date</span>
                                    <span>Due Date</span>
                                </span>
                            </span>
                        </th>
                        <th class="tb-tnx-amount">
                            <span class="tb-tnx-total">Total</span>
                            <span class="tb-tnx-status d-none d-md-inline-block">Status</span>
                        </th>
                </thead>
                <tbody>
                    {% if transaction %}
                    {% for t in transaction %}
                    <tr class="tb-tnx-item">
                        <td class="tb-tnx-id">
                            <a href="#"><span>{{ t.billing_id }}</span></a>
                        </td>
                        <td class="tb-tnx-info">
                            <div class="tb-tnx-desc">
                                <span class="title">{{ t.user }}</span>
                            </div>
                            <div class="tb-tnx-date">
                                <span class="date">{{ t.timestamp|date:'m-d-Y' }}</span>
                                <span class="date">{{ t.get_expaitry_day|date:'m-d-Y' }}</span>
                            </div>
                        </td>
                        <td class="tb-tnx-amount">
                            <div class="tb-tnx-total">
                                <span class="amount">{{ user.currency }} {{ t.amount }}</span>
                            </div>
                            <div class="tb-tnx-status">
                                <span class="badge badge-dot badge-{% if t.success %}success{% else %}Danger{% endif %}">{% if t.success %}Complet{% else %}Canceld{% endif %}</span>
                            </div>
                        </td>
                    </tr><!-- .tb-tnx-item -->
                    {% endfor %}
                    {% else %}
                    <tr>
                        <p class="p-3">No Hestory</p>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div><!-- .card -->
    </div><!-- .nk-block -->

</div>
     
{% endblock %}
          
            